<!-- Dashboard Custom Styles -->
<link rel="stylesheet" href="/css/dashboard.css">

<div class="space-y-6">

    <!-- Welcome / Hero -->
    <section class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
            <h2 class="text-2xl md:text-3xl font-semibold tracking-tight">
                Dobrodo≈°ao nazad, <span class="text-blue-400"><%= user || "trader" %></span>
            </h2>
            <p class="mt-1 text-sm text-slate-400">
                Centralni panel za tvoj DTrade AI scalping engine.
            </p>
            <p class="mt-1 text-xs text-slate-500">
                Last updated: <%= currentTime %>
            </p>
        </div>

        <div class="flex flex-wrap items-center gap-2 text-xs">
            <span class="inline-flex items-center gap-1 px-2 py-1 rounded-full bg-emerald-500/10 border border-emerald-500/40 text-emerald-300">
                <span class="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"></span>
                Engine Online
            </span>
            <span class="inline-flex items-center gap-1 px-2 py-1 rounded-full bg-blue-500/10 border border-blue-500/40 text-blue-300">
                Market Scanner
            </span>
            <span class="inline-flex items-center gap-1 px-2 py-1 rounded-full bg-slate-800 text-slate-300">
                Mode: <span class="font-semibold text-slate-100">SIM</span>
            </span>
        </div>
    </section>

    <!-- Real-time Market Data -->
    <section class="space-y-4">
        <h3 class="text-lg font-semibold">Live Market Data</h3>

        <!-- Live Tickers -->
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-semibold text-slate-300">Live Market Tickers</h4>
                <div class="flex items-center gap-2">
                    <span id="ws-status" class="inline-flex items-center gap-1 px-2 py-1 rounded-full bg-slate-500/10 border border-slate-500/40 text-slate-400 text-xs">
                        <span class="w-2 h-2 rounded-full bg-slate-400"></span>
                        Connecting...
                    </span>
                </div>
            </div>
            <div id="tickers-container">
                <div class="text-center text-slate-500 text-sm py-4">Loading tickers...</div>
            </div>
        </div>

        <!-- Live Trade Feed -->
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-semibold text-slate-300">Recent Trades</h4>
                <div class="text-xs text-slate-500">Last 25 trades</div>
            </div>
            <div class="border border-slate-700 rounded-lg">
                <div class="max-h-60 overflow-y-auto scrollbar-thin scrollbar-track-slate-800 scrollbar-thumb-slate-600">
                    <table class="w-full text-xs">
                        <thead class="sticky top-0 bg-slate-800 z-10 border-b border-slate-700">
                            <tr>
                                <th class="text-left py-2 px-2 text-slate-400 font-medium whitespace-nowrap">Time</th>
                                <th class="text-left py-2 px-2 text-slate-400 font-medium whitespace-nowrap">Symbol</th>
                                <th class="text-left py-2 px-2 text-slate-400 font-medium whitespace-nowrap">Side</th>
                                <th class="text-right py-2 px-2 text-slate-400 font-medium whitespace-nowrap">Price</th>
                                <th class="text-right py-2 px-2 text-slate-400 font-medium whitespace-nowrap">Size</th>
                                <th class="text-left py-2 px-2 text-slate-400 font-medium whitespace-nowrap">Dir</th>
                            </tr>
                        </thead>
                        <tbody id="trades-container" class="bg-slate-900/60">
                            <tr>
                                <td colspan="6" class="text-center text-slate-500 py-4">Loading trades...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Storage Stats -->
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-semibold text-slate-300">Data Storage Statistics</h4>
                <div class="text-xs text-slate-500">Today's Files</div>
            </div>
            <div id="storage-stats" class="grid grid-cols-2 md:grid-cols-4 gap-4 text-xs">
                <div class="text-center">
                    <div class="text-slate-400">Ticker Files</div>
                    <div class="text-lg font-semibold text-slate-200" id="ticker-files">-</div>
                </div>
                <div class="text-center">
                    <div class="text-slate-400">Trade Files</div>
                    <div class="text-lg font-semibold text-slate-200" id="trade-files">-</div>
                </div>
                <div class="text-center">
                    <div class="text-slate-400">Ticker Size</div>
                    <div class="text-lg font-semibold text-slate-200" id="ticker-size">-</div>
                </div>
                <div class="text-center">
                    <div class="text-slate-400">Trade Size</div>
                    <div class="text-lg font-semibold text-slate-200" id="trade-size">-</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Universe Section -->
    <section class="space-y-4">
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <div class="flex items-center justify-between mb-4">
                <h4 class="text-sm font-semibold text-slate-300">Market Universe</h4>
                <div class="text-xs text-slate-500" id="universe-last-update">Loading...</div>
            </div>

            <!-- Universe Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 text-xs">
                <div class="text-center">
                    <div class="text-slate-400">Total Symbols</div>
                    <div class="text-lg font-semibold text-slate-200" id="total-symbols">-</div>
                </div>
                <div class="text-center">
                    <div class="text-slate-400">Prime</div>
                    <div class="text-lg font-semibold text-emerald-300" id="prime-count">-</div>
                </div>
                <div class="text-center">
                    <div class="text-slate-400">Normal</div>
                    <div class="text-lg font-semibold text-blue-300" id="normal-count">-</div>
                </div>
                <div class="text-center">
                    <div class="text-slate-400">Wild</div>
                    <div class="text-lg font-semibold text-amber-300" id="wild-count">-</div>
                </div>
            </div>

            <!-- Category Tabs -->
            <div class="flex flex-wrap gap-1 mb-4 text-xs">
                <button class="universe-tab px-3 py-1.5 rounded-md bg-emerald-600/20 border border-emerald-600/40 text-emerald-300 font-medium" data-category="Prime">
                    Prime
                </button>
                <button class="universe-tab px-3 py-1.5 rounded-md border border-slate-600 text-slate-400 hover:bg-slate-800" data-category="Normal">
                    Normal
                </button>
                <button class="universe-tab px-3 py-1.5 rounded-md border border-slate-600 text-slate-400 hover:bg-slate-800" data-category="Wild">
                    Wild
                </button>
                <button class="universe-tab px-3 py-1.5 rounded-md border border-slate-600 text-slate-400 hover:bg-slate-800" data-category="All">
                    All
                </button>
            </div>

            <!-- Universe Table -->
            <div class="border border-slate-700 rounded-lg">
                <div class="max-h-64 overflow-y-auto scrollbar-thin scrollbar-track-slate-800 scrollbar-thumb-slate-600">
                    <table class="w-full text-xs">
                        <thead class="bg-slate-800/50 sticky top-0">
                            <tr class="border-b border-slate-700">
                                <th class="text-left p-2 text-slate-400 font-medium">Symbol</th>
                                <th class="text-left p-2 text-slate-400 font-medium">Category</th>
                                <th class="text-right p-2 text-slate-400 font-medium">Leverage</th>
                                <th class="text-left p-2 text-slate-400 font-medium">Status</th>
                            </tr>
                        </thead>
                        <tbody id="universe-table-body" class="divide-y divide-slate-700">
                            <tr>
                                <td colspan="5" class="text-center text-slate-500 p-4">Loading universe data...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Stat cards -->
    <section class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4">
        <!-- Portfolio -->
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs text-slate-400">Portfolio Value</p>
                    <p class="mt-1 text-2xl font-semibold tracking-tight">
                        $12,847.50
                    </p>
                </div>
                <div class="w-10 h-10 rounded-full bg-blue-500/10 flex items-center justify-center">
                    <svg class="w-5 h-5 text-blue-400" xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 3v18" />
                        <path d="M5 9h14" />
                        <path d="M7 5h10v4H7z" />
                    </svg>
                </div>
            </div>
            <p class="mt-2 text-xs text-emerald-400">
                +2.45% danas
            </p>
        </div>

        <!-- Active trades -->
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs text-slate-400">Active Trades</p>
                    <p class="mt-1 text-2xl font-semibold tracking-tight">
                        7
                    </p>
                </div>
                <div class="w-10 h-10 rounded-full bg-emerald-500/10 flex items-center justify-center">
                    <svg class="w-5 h-5 text-emerald-400" xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 19l4-9 4 6 4-10 4 13" />
                        <path d="M2 21h20" />
                    </svg>
                </div>
            </div>
            <p class="mt-2 text-xs text-slate-400">
                Praƒáenje tr≈æi≈°nih scalp prilika
            </p>
        </div>

        <!-- Winrate -->
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs text-slate-400">Success Rate (30d)</p>
                    <p class="mt-1 text-2xl font-semibold tracking-tight">
                        87.3%
                    </p>
                </div>
                <div class="w-10 h-10 rounded-full bg-amber-500/10 flex items-center justify-center">
                    <svg class="w-5 h-5 text-amber-400" xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 3l3 7h7l-5.5 4.2L18 21l-6-3.8L6 21l1.5-6.8L2 10h7z" />
                    </svg>
                </div>
            </div>
            <p class="mt-2 text-xs text-slate-400">
                Bazirano na istoriji tvojih scalpova
            </p>
        </div>

        <!-- Alerts -->
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs text-slate-400">Alerts</p>
                    <p class="mt-1 text-2xl font-semibold tracking-tight">
                        3
                    </p>
                </div>
                <div class="w-10 h-10 rounded-full bg-red-500/10 flex items-center justify-center">
                    <svg class="w-5 h-5 text-red-400" xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 9v4" />
                        <path d="M12 17h.01" />
                        <path d="M10.29 3.86L1.82 18a1 1 0 0 0 .86 1.5h18.64a1 1 0 0 0 .86-1.5L13.71 3.86a1 1 0 0 0-1.72 0z" />
                    </svg>
                </div>
            </div>
            <p class="mt-2 text-xs text-slate-400">
                Novi scalp signali / riziƒçni tokene
            </p>
        </div>
    </section>

    <!-- Quick actions -->
    <section class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <h3 class="text-sm font-semibold mb-2">
                Quick Actions
            </h3>
            <p class="text-xs text-slate-400 mb-3">
                Najƒçe≈°ƒáe radnje koje ƒáe≈° koristiti tokom sesije.
            </p>
            <div class="flex flex-wrap gap-2">
                <a href="/trades"
                   class="px-3 py-1.5 rounded-md text-xs font-semibold bg-blue-600 hover:bg-blue-500">
                    View Live Trades
                </a>
                <a href="/engine"
                   class="px-3 py-1.5 rounded-md text-xs font-semibold bg-slate-800 hover:bg-slate-700">
                    Engine Status
                </a>
                <a href="/settings"
                   class="px-3 py-1.5 rounded-md text-xs font-semibold bg-slate-800 hover:bg-slate-700">
                    Risk & TP/SL
                </a>
            </div>
        </div>

        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <h3 class="text-sm font-semibold mb-2">
                Session Info
            </h3>
            <ul class="space-y-1 text-xs text-slate-400">
                <li>‚Ä¢ User: <span class="text-slate-200"><%= user || "admin" %></span></li>
                <li>‚Ä¢ Mode: SIM (planirano LIVE kasnije)</li>
                <li>‚Ä¢ WS feed: Bybit linear USDT perp</li>
                <li>‚Ä¢ Scalper verzija: Core v1 ¬∑ Panel v1</li>
            </ul>
        </div>
    </section>

    <!-- FAZA 3: Microstructure Analytics -->
    <section class="space-y-4">
        <div class="flex items-center justify-between">
            <div>
                <h3 class="text-lg font-semibold text-slate-200">Microstructure Analytics</h3>
                <p class="text-xs text-slate-400 mt-1">FAZA 3 - Real-time market microstructure monitoring</p>
            </div>
            <a href="/monitor-micro" class="px-3 py-1.5 rounded-md text-xs font-semibold bg-blue-600 hover:bg-blue-500 transition-colors">
                Open Microstructure Monitor
            </a>
        </div>

        <!-- Microstructure Stats -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-400">Active Symbols</p>
                        <p class="mt-1 text-2xl font-semibold tracking-tight" id="micro-symbols-count">-</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-blue-500/10 flex items-center justify-center">
                        <svg class="w-5 h-5 text-blue-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 12h18m-9-9v18" />
                        </svg>
                    </div>
                </div>
                <p class="mt-2 text-xs text-slate-400" id="micro-symbols-status">Loading...</p>
            </div>

            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-400">Data Flow Rate</p>
                        <p class="mt-1 text-2xl font-semibold tracking-tight text-emerald-400" id="micro-data-rate">- evt/s</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-emerald-500/10 flex items-center justify-center">
                        <div class="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"></div>
                    </div>
                </div>
                <p class="mt-2 text-xs text-slate-400">Events per second</p>
            </div>

            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-400">Storage Today</p>
                        <p class="mt-1 text-2xl font-semibold tracking-tight text-amber-400" id="micro-storage">- MB</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-amber-500/10 flex items-center justify-center">
                        <svg class="w-5 h-5 text-amber-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                            <polyline points="14,2 14,8 20,8" />
                        </svg>
                    </div>
                </div>
                <p class="mt-2 text-xs text-slate-400">Microstructure data</p>
            </div>

            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-400">System Health</p>
                        <p class="mt-1 text-2xl font-semibold tracking-tight text-green-400" id="micro-health">Good</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-green-500/10 flex items-center justify-center">
                        <svg class="w-5 h-5 text-green-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 12l2 2 4-4" />
                            <circle cx="12" cy="12" r="10" />
                        </svg>
                    </div>
                </div>
                <p class="mt-2 text-xs text-slate-400" id="micro-health-details">All systems operational</p>
            </div>
        </div>

        <!-- Top Symbols by Activity -->
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <div class="flex items-center justify-between mb-4">
                <h4 class="text-sm font-semibold text-slate-300">Most Active Symbols (Microstructure)</h4>
                <div class="text-xs text-slate-500" id="micro-last-update">Real-time</div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div id="micro-top-symbols" class="space-y-2">
                    <div class="flex justify-between items-center text-xs py-1 px-2 rounded bg-slate-800/50">
                        <span class="text-slate-400">Loading symbols...</span>
                        <span class="text-slate-500">-</span>
                    </div>
                </div>

                <div class="space-y-2">
                    <div class="text-xs text-slate-400 mb-2">Recent Events</div>
                    <div id="micro-recent-events" class="space-y-1 text-xs">
                        <div class="text-slate-500">Loading events...</div>
                    </div>
                </div>

                <div class="space-y-2">
                    <div class="text-xs text-slate-400 mb-2">Performance Metrics</div>
                    <div class="space-y-1 text-xs">
                        <div class="flex justify-between">
                            <span class="text-slate-400">Avg Spread:</span>
                            <span class="text-slate-300 font-mono" id="micro-avg-spread">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-400">Trade Volume:</span>
                            <span class="text-slate-300 font-mono" id="micro-trade-volume">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-400">Update Freq:</span>
                            <span class="text-slate-300 font-mono" id="micro-update-freq">-/min</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FAZA 4: Feature Engine -->
    <section class="space-y-4">
        <div class="flex items-center justify-between">
            <div>
                <h3 class="text-lg font-semibold text-slate-200">Feature Engine</h3>
                <p class="text-xs text-slate-400 mt-1">FAZA 4 - Advanced market analysis & signal generation</p>
            </div>
            <div class="flex items-center gap-2">
                <span class="inline-flex items-center gap-1 px-2 py-1 rounded-full bg-violet-500/10 border border-violet-500/40 text-violet-300 text-xs">
                    <span class="w-2 h-2 rounded-full bg-violet-400 animate-pulse"></span>
                    FAZA 4 Active
                </span>
            </div>
        </div>

        <!-- Feature Engine Stats -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-400">Active Symbols</p>
                        <p class="mt-1 text-2xl font-semibold tracking-tight" id="features-symbols-count">-</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-violet-500/10 flex items-center justify-center">
                        <svg class="w-5 h-5 text-violet-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 19c-5 0-8-3-8-8s3-8 8-8 8 3 8 8-3 8-8 8" />
                            <path d="M8 14s1.5 2 4 2 4-2 4-2" />
                            <line x1="9" y1="9" x2="9.01" y2="9" />
                            <line x1="15" y1="9" x2="15.01" y2="9" />
                        </svg>
                    </div>
                </div>
                <p class="mt-2 text-xs text-slate-400" id="features-symbols-status">Analyzing markets...</p>
            </div>

            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-400">Updates/Second</p>
                        <p class="mt-1 text-2xl font-semibold tracking-tight text-emerald-400" id="features-update-rate">-</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-emerald-500/10 flex items-center justify-center">
                        <div class="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"></div>
                    </div>
                </div>
                <p class="mt-2 text-xs text-slate-400">Real-time processing</p>
            </div>

            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-400">Avg Update Time</p>
                        <p class="mt-1 text-2xl font-semibold tracking-tight text-blue-400" id="features-avg-time">- ms</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-blue-500/10 flex items-center justify-center">
                        <svg class="w-5 h-5 text-blue-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10" />
                            <polyline points="12,6 12,12 16,14" />
                        </svg>
                    </div>
                </div>
                <p class="mt-2 text-xs text-slate-400">Performance metric</p>
            </div>

            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-400">System Status</p>
                        <p class="mt-1 text-2xl font-semibold tracking-tight text-green-400" id="features-health">Healthy</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-green-500/10 flex items-center justify-center">
                        <svg class="w-5 h-5 text-green-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
                        </svg>
                    </div>
                </div>
                <p class="mt-2 text-xs text-slate-400" id="features-health-details">All engines operational</p>
            </div>
        </div>

        <!-- Engine Status Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <h4 class="text-sm font-semibold text-slate-300 mb-3">Active Engines</h4>
                <div class="space-y-2" id="features-engines">
                    <div class="flex items-center justify-between text-xs">
                        <span class="text-slate-400">Loading engines...</span>
                        <span class="text-slate-500">-</span>
                    </div>
                </div>
            </div>

            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <h4 class="text-sm font-semibold text-slate-300 mb-3">Performance Metrics</h4>
                <div class="space-y-2" id="features-performance">
                    <div class="flex items-center justify-between text-xs">
                        <span class="text-slate-400">Symbols Processed</span>
                        <span class="text-slate-300" id="perf-symbols">-</span>
                    </div>
                    <div class="flex items-center justify-between text-xs">
                        <span class="text-slate-400">Total Analyses</span>
                        <span class="text-slate-300" id="perf-analyses">-</span>
                    </div>
                    <div class="flex items-center justify-between text-xs">
                        <span class="text-slate-400">Error Count</span>
                        <span class="text-red-400" id="perf-errors">-</span>
                    </div>
                </div>
            </div>

            <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
                <h4 class="text-sm font-semibold text-slate-300 mb-3">System Memory</h4>
                <div class="space-y-2" id="features-memory">
                    <div class="flex items-center justify-between text-xs">
                        <span class="text-slate-400">RSS Memory</span>
                        <span class="text-slate-300" id="mem-rss">- MB</span>
                    </div>
                    <div class="flex items-center justify-between text-xs">
                        <span class="text-slate-400">Heap Used</span>
                        <span class="text-slate-300" id="mem-heap">- MB</span>
                    </div>
                    <div class="flex items-center justify-between text-xs">
                        <span class="text-slate-400">Uptime</span>
                        <span class="text-emerald-400" id="mem-uptime">- sec</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Feature Analysis Overview -->
        <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-4">
            <div class="flex items-center justify-between mb-4">
                <h4 class="text-sm font-semibold text-slate-300">Feature Analysis Overview</h4>
                <button onclick="refreshFeatureData()" class="px-2 py-1 rounded text-xs bg-violet-600 hover:bg-violet-500 transition-colors">
                    Refresh
                </button>
            </div>

            <div id="features-overview" class="space-y-2">
                <div class="flex justify-between items-center text-xs py-2 px-3 rounded bg-slate-800/50">
                    <span class="text-slate-400">Loading feature analysis...</span>
                    <span class="text-slate-500">-</span>
                </div>
            </div>
        </div>
    </section>

</div>

<!-- Real-time Dashboard JavaScript -->
<script type="module">
    // Import dashboard modules - Cache bust: <%= Date.now() %>
    import { DashboardAPI } from '/js/api-client.js';

    // Global dashboard instance for button callbacks
    let globalDashboard = null;

    // Global function for Feature Engine refresh button
    window.refreshFeatureData = function() {
        if (globalDashboard) {
            console.log("üîÑ Manual Feature Engine refresh triggered");
            globalDashboard.updateFeatureEngineStats();
        }
    };

    // Start dashboard when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
        console.log("üéØ DOM Content Loaded - Starting Dashboard...");
        console.log("üèóÔ∏è Creating DashboardAPI instance...");
        const dashboard = new DashboardAPI();
        globalDashboard = dashboard; // Store for global access
        console.log("‚ñ∂Ô∏è Starting dashboard...");
        dashboard.start();

        // Set up Universe category tab handlers
        const categoryTabs = document.querySelectorAll('.universe-tab');
        categoryTabs.forEach(tab => {
            tab.addEventListener('click', async (e) => {
                e.preventDefault();
                const category = tab.dataset.category;

                // Update active tab
                categoryTabs.forEach(t => {
                    t.classList.remove('bg-blue-600', 'text-white');
                    t.classList.add('bg-slate-700', 'text-slate-300');
                });
                tab.classList.remove('bg-slate-700', 'text-slate-300');
                tab.classList.add('bg-blue-600', 'text-white');

                // Update current category and fetch symbols
                dashboard.currentCategory = category;
                await dashboard.updateSymbols(category);
            });
        });

        // Set Prime as default active tab
        const primeTab = document.querySelector('[data-category="Prime"]');
        if (primeTab) {
            primeTab.classList.remove('bg-slate-700', 'text-slate-300');
            primeTab.classList.add('bg-blue-600', 'text-white');
        }
    });
</script>
