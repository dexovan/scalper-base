<!DOCTYPE html>
<html lang="en" class="bg-slate-950">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <title><%= title ? (title + " | DTrade") : "DTrade | Dexovan AI Scalper" %></title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-slate-950 text-slate-100">

<%
  // Ako je hideChrome = true â†’ nema sidebar-a, nema header-a (koristi se za login)
  const chromeOff = typeof hideChrome !== 'undefined' && hideChrome;
%>

<% if (chromeOff) { %>
  <!-- Prazan layout za login / auth stranice -->
  <main class="min-h-screen flex items-center justify-center p-4">
    <%- body %>
  </main>

<% } else { %>
  <!-- FULL ADMIN LAYOUT SA SIDEBAR-om -->
  <div class="min-h-screen flex bg-slate-950">

    <!-- SIDEBAR -->
    <aside class="hidden md:flex md:w-64 flex-col bg-slate-900 border-r border-slate-800">
      <div class="h-16 flex items-center px-6 border-b border-slate-800">
        <div class="flex items-center space-x-2">
          <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center text-blue-400 text-xl">
            âš¡
          </div>
          <div>
            <div class="text-sm font-semibold text-slate-100">DTrade</div>
            <div class="text-xs text-slate-400">Dexovan AI Scalper</div>
          </div>
        </div>
      </div>

      <nav class="flex-1 px-3 py-4 space-y-1 text-sm">
        <!-- Dashboard -->
        <a href="/"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition
                  <%= (title === 'Dashboard') ? 'bg-slate-800 text-blue-400' : 'text-slate-300' %>">
          <span class="mr-2">ğŸ“Š</span>
          <span>Dashboard</span>
        </a>

        <!-- Monitor -->
        <a href="/monitor"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition
                  <%= (title === 'Monitor') ? 'bg-slate-800 text-blue-400' : 'text-slate-300' %>">
          <span class="mr-2">ğŸ–¥ï¸</span>
          <span>System Monitor</span>
        </a>

        <!-- Microstructure Monitor -->
        <a href="/monitor-micro"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition
                  <%= (title === 'Microstructure Monitor') ? 'bg-slate-800 text-blue-400' : 'text-slate-300' %>">
          <span class="mr-2">ğŸ“ˆ</span>
          <span>Microstructure</span>
        </a>

        <!-- Regime Monitor -->
        <a href="/regime-monitor"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition
                  <%= (title === 'Regime Monitor') ? 'bg-slate-800 text-blue-400' : 'text-slate-300' %>">
          <span class="mr-2">ğŸ›¡ï¸</span>
          <span>Regime Monitor</span>
        </a>

        <!-- Signal Scanner -->
        <a href="/scanner"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition
                  <%= (title === 'Signal Scanner') ? 'bg-slate-800 text-blue-400' : 'text-slate-300' %>">
          <span class="mr-2">ğŸ¯</span>
          <span>Signal Scanner</span>
        </a>

        <!-- State Machine Monitor -->
        <a href="/states"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition
                  <%= (title === 'State Machine Monitor') ? 'bg-slate-800 text-blue-400' : 'text-slate-300' %>">
          <span class="mr-2">ğŸ”„</span>
          <span>State Machine</span>
        </a>

        <!-- Risk Monitor -->
        <a href="/risk"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition
                  <%= (title === 'Risk Monitor') ? 'bg-slate-800 text-blue-400' : 'text-slate-300' %>">
          <span class="mr-2">ğŸ’°</span>
          <span>Risk Monitor</span>
        </a>

        <!-- Positions & TP/SL -->
        <a href="/positions"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition
                  <%= (title === 'Positions & TP/SL') ? 'bg-slate-800 text-blue-400' : 'text-slate-300' %>">
          <span class="mr-2">ğŸ“ˆ</span>
          <span>Positions & TP/SL</span>
        </a>

        <!-- Ostalo za kasnije (placeholderi) -->
        <a href="/trades"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition text-slate-500 cursor-not-allowed">
          <span class="mr-2">ğŸ“</span>
          <span>Trades (uskoro)</span>
        </a>

        <a href="/engine"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition text-slate-500 cursor-not-allowed">
          <span class="mr-2">âš™ï¸</span>
          <span>Engine (uskoro)</span>
        </a>

        <a href="/settings"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-slate-800 transition text-slate-500 cursor-not-allowed">
          <span class="mr-2">ğŸ› </span>
          <span>Settings (uskoro)</span>
        </a>
      </nav>

      <div class="border-t border-slate-800 px-4 py-3 text-xs text-slate-500">
        <div>DTrade Â© <%= new Date().getFullYear() %></div>
        <div class="text-[11px] text-slate-600">Dexovan AI Scalper Engine</div>
      </div>
    </aside>

    <!-- MAIN PANEL (HEADER + CONTENT) -->
    <div class="flex-1 flex flex-col min-h-screen">

      <!-- HEADER -->
      <header class="h-16 flex items-center justify-between px-4 md:px-6 border-b border-slate-800 bg-slate-900/80 backdrop-blur">
        <div class="flex items-center space-x-3">
          <span class="md:hidden text-xl">âš¡</span>
          <div>
            <div class="text-sm font-semibold text-slate-100"><%= title || 'DTrade' %></div>
            <div class="text-xs text-slate-400 hidden sm:block">Real-time AI scalping control panel</div>
          </div>
        </div>

        <div class="flex items-center space-x-3">
          <% if (locals.user) { %>
            <div class="hidden sm:block text-sm text-slate-300">
              ğŸ‘¤ <span class="font-medium"><%= locals.user %></span>
            </div>
          <% } %>
          <a href="/logout"
             class="px-3 py-1.5 rounded-md bg-red-600 hover:bg-red-500 text-xs font-medium text-white transition">
            Logout
          </a>
        </div>
      </header>

      <!-- PAGE CONTENT -->
      <main class="flex-1 px-4 md:px-6 py-4 bg-slate-950">
        <%- body %>
      </main>

      <!-- FOOTER -->
      <footer class="border-t border-slate-800 bg-slate-900 py-3 text-center text-xs text-slate-500">
        DTrade Â· Dexovan AI Scalper Â· <span class="text-slate-400">Engine v1.0</span>
      </footer>
    </div>
  </div>
<% } %>

</body>
</html>
