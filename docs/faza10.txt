Super, ovo je â€œkrunisanjeâ€ celog sistema â€“ FAZA 10. Idemo da je zaokruÅ¾imo kao pravi **production rollout plan**. ğŸ§ âš™ï¸

---

# ğŸš€ FAZA 10 â€” LIVE TRADING (FINAL ROLLOUT)

**Cilj:**
Bezbedan, kontrolisan prelazak sa **paper trading** na **real Bybit LIVE** uz minimalan rizik i jasne â€œpanicâ€ procedure.

Osnovna filozofija FAZE 10:

> *â€œSistem je veÄ‡ dokazan na papiru, LIVE je samo promena izvora PnL-a, ne promena logike.â€*

---

## ğŸ“‚ 10.0 Struktura FAZE 10

```
FAZA 10
â”‚
â”œâ”€â”€ 10.1 Live mode arhitektura (flags + config)
â”œâ”€â”€ 10.2 Pre-LIVE checklist (Dan -1 / Dan 0)
â”œâ”€â”€ 10.3 FAZA 10.1 â€“ Micro-Live ($100â€“200)
â”œâ”€â”€ 10.4 FAZA 10.2 â€“ Small-Live ($500)
â”œâ”€â”€ 10.5 FAZA 10.3 â€“ Scale-Up ($1K â†’ $5K+)
â”œâ”€â”€ 10.6 Incident Response & Rollback
â””â”€â”€ 10.7 Live performance review & tuning
```

---

## 10.1 LIVE MODE ARHITEKTURA

### 10.1.1 Environment switch

Uvedi centralni **MODE flag**:

```env
TRADING_MODE=PAPER | LIVE
CAPITAL_TIER=MICRO | SMALL | NORMAL
```

U kodu:

```js
export function isLiveMode() {
  return process.env.TRADING_MODE === 'LIVE';
}

export function isPaperMode() {
  return process.env.TRADING_MODE !== 'LIVE';
}
```

Svi kritiÄni moduli (executionRouter, orderManager, PnL tracker, logging) **NE UMEJU** da rade â€œna svoju rukuâ€ â€“ *sve prolazi preko centralnog routera* koji poÅ¡tuje `TRADING_MODE`.

---

### 10.1.2 Execution Router â€“ centralna taÄka

`src/execution/router.js`:

```js
export class ExecutionRouter {
  constructor({ liveClient, paperEngine, mode }) {
    this.liveClient  = liveClient;  // Bybit REST/WS
    this.paperEngine = paperEngine; // FAZA 8 simulator
    this.mode        = mode;        // 'PAPER' | 'LIVE'
  }

  async placeOrder(order) {
    if (this.mode === 'PAPER') {
      return this.paperEngine.placeOrder(order);
    }
    return this.liveClient.placeOrder(order);
  }

  async closePosition(args) { /* isto */ }
  async cancelOrders(filter) { /* isto */ }
}
```

**Zlatno pravilo:** *nigde u kodu ne sme direktno da se zove Bybit API â€“ sve ide preko ExecutionRouter-a.*

---

### 10.1.3 Live constraints per â€œcapital tierâ€

`CAPITAL_TIER` definiÅ¡e limite:

```js
const TIERS = {
  MICRO: {
    maxCapital: 200,
    maxPerTrade: 25,
    maxConcurrent: 1,
    maxDailyTrades: 3,
    maxDailyLoss: -2,   // %
  },
  SMALL: {
    maxCapital: 500,
    maxPerTrade: 50,
    maxConcurrent: 2,
    maxDailyTrades: 5,
    maxDailyLoss: -3,
  },
  NORMAL: {
    maxCapital: 1000,
    maxPerTrade: 100,
    maxConcurrent: 3,
    maxDailyTrades: 7,
    maxDailyLoss: -5,
  },
};
```

Pre svake nove pozicije `riskManager` gleda:

* koji je `CAPITAL_TIER`
* kakav je trenutni `dailyPnL`
* koliko je veÄ‡ otvorenih pozicija
  â†’ ako bilo Å¡ta krÅ¡i limite, **neÄ‡e ni probati da poÅ¡alje order**.

---

## 10.2 PRE-LIVE CHECKLIST (OBAVEZNO!)

Ovo radiÅ¡ **dan pre** prvog LIVE testa (ili jutro pre).

### 10.2.1 TehniÄki pre-check

1. âœ… VPS health: CPU < 70%, RAM ok, disk free > 10GB
2. âœ… PM2 procesi: `engine`, `monitor`, `dashboard` svi `online`
3. âœ… Log rotate radi (da logovi ne napune disk)
4. âœ… Web dashboard `/monitor` radi iz Å vedske (tvoj browser)
5. âœ… WS konekcije na Bybit stabilne (nema reconnect spam)

### 10.2.2 Konfiguracioni pre-check

1. `TRADING_MODE=PAPER` â€“ proveri da sistem zaista radi u paperu i hvata LIVE feed
2. `config/trading.json` â€“ pozicije: **$25, 25x**, TP1/2/3 kao dogovoreno
3. `config/safety.json` â€“ kill-switch pragovi:

   * VIX > 30 = stop
   * daily loss per tier setovan
4. `config/skip.json` â€“ weekend & time filters aktivni (Monâ€“Fri, 09â€“18 UTC)

### 10.2.3 Simulirani â€œdry runâ€ (Dan 0 jutro)

* ostavi `TRADING_MODE=PAPER`, ali **glumi kao da je LIVE**:

  * gledaj board
  * prati signale
  * proveri da se TP/DCA logika ponaÅ¡a kako treba
* ako je sve u redu nekoliko sati â†’ spreman si za MICRO-LIVE.

---

## 10.3 FAZA 10.1 â€” MICRO-LIVE ($100â€“200)

**Cilj:**
TestiraÅ¡ **REAL EXECUTION** sa **minimalnim novcem**.

### 10.3.1 Setup

* `TRADING_MODE=LIVE`
* `CAPITAL_TIER=MICRO`
* Bybit API key:

  * permissions: **trade only**, bez withdrawal-a
  * IP whitelist (VPS IP)

### 10.3.2 OgraniÄenja (hard-coded preko configa)

* max kapital koji â€œraÄunaÅ¡â€: $200
* max per trade: $25
* max concurrent: 1 pozicija
* max dnevno: 3 trade-a
* max dnevni loss: -2%

### 10.3.3 Pravila za ovaj period

* Trajanje: **minimum 20 live trejdova**
* Target:

  * Win rate â‰¥ 60%
  * nema kritiÄnih bugova (nedefinisani state, dupli orderi, â€œghostâ€ pozicije)
* Svaki trade:

  * odmah posle zatvaranja: ruÄno uporedi Bybit history vs `trades.log`
  * proveri da PnL i fees imaju smisla

### 10.3.4 Kada je FAZA 10.1 uspeÅ¡na?

* 20+ trejdova
* Winrate â‰¥ 60%
* Nema:

  * duplih entry-ja
  * nelogiÄnih TP hitova
  * neobjaÅ¡njenih DCA
* killSwitch NIJE morao da spaÅ¡ava katastrofu (ili ako jeste â€“ radio je perfektno)

Ako bilo Å¡ta bude Äudno â†’ **vrati TRADING_MODE=PAPER** i debaguj.

---

## 10.4 FAZA 10.2 â€” SMALL-LIVE ($500)

Kada MICRO-LIVE proÄ‘e ok â†’ prelaziÅ¡ na **kontrolisani rast**.

### 10.4.1 Setup

* `TRADING_MODE=LIVE`
* `CAPITAL_TIER=SMALL`
* max per trade: $50
* max concurrent: 2
* max trades/day: 5
* daily loss: -3%

### 10.4.2 Ciljevi

* Min 30 dodatnih trejdova (ukupno 50 LIVE)
* Winrate â‰¥ 65%
* Nema â€œpatternâ€ gubitaka (tipa svi losing trades u istoj zoni vremena ili na istom tipu kretanja)

### 10.4.3 PraÄ‡enje

Dashboard doda sekciju:

* â€œLIVE mode: SMALLâ€
* â€œTier: SMALL, limits: â€¦â€
* tabelu: `liveStats`:

  * ukupni PnL
  * 7d PnL
  * winrate (last 20)
  * avg hold time (da li je i dalje ~26min)

Ako primeÄ‡ujeÅ¡ da se LIVE dosta razlikuje od paper logike (slippage, partial fills) â†’ FAZA 9 param tuning + nazad na SMALL dok se ne izravna.

---

## 10.5 FAZA 10.3 â€” SCALE-UP ($1K â†’ $5K+)

Ovo radiÅ¡ tek kad:

* imaÅ¡ **50+ micro/small LIVE trejdova**
* sistem se ponaÅ¡a PREDVIDLJIVO
* nema panike kod svake sveÄ‡e ğŸ˜„

### 10.5.1 Setup

* `CAPITAL_TIER=NORMAL`
* `maxPerTrade = $100`
* `maxConcurrent = 3`
* `maxDailyTrades = 7`
* `maxDailyLoss = -5%`

**Pravilo rasta:**

* Start: `$1,000`
* Kad equity (real PnL) preÄ‘e `$2,000`:

  * moÅ¾eÅ¡ podiÄ‡i maxPerTrade na `$150`
* Kad equity > `$5,000`:

  * moÅ¾eÅ¡ poÄeti razmiÅ¡ljanje o â€œportfolio heatâ€ logici (kasnija faza)

**NIKAD:**

* ne diÅ¾eÅ¡ leverage iznad dogovorenog (npr. 25x)
* ne diÅ¾eÅ¡ maxDailyLoss preko -5%

---

## 10.6 INCIDENT RESPONSE & ROLLBACK

Mora postojati jasan â€œÅ¡ta ako sve ode u PM?â€ plan.

### 10.6.1 Kategorije incidenta

1. **TehniÄki bug**

   * dupli entry
   * pozicija ostala otvorena bez TPa
   * mismatch izmeÄ‘u Bybit i internog stanja

2. **Market anomaly**

   * ogroman wick
   * exchange partial outage
   * bizaran slippage

3. **Safety failure**

   * safety modul trebao da stopira, a nije
   * daily loss > definisanog praga

### 10.6.2 Procedura (Å¡ablon)

1. **Hitno:**

   * RuÄno: zatvori sve pozicije u Bybit UI ako si u panici
   * Pokreni: `killSwitch.manualTrigger("manual_panic")` (endpoint npr. `/api/admin/kill`)

2. **Posle smirivanja:**

   * Setuj: `TRADING_MODE=PAPER`
   * Prescani `logs/` za zadnjih 15 minuta
   * ZapiÅ¡i incident u `INCIDENTS.md`:

     * vreme
     * simptom
     * uzrok
     * fix

3. **Rollback pravilo:**

   * Posle ozbiljnog incidenta â†’ ideÅ¡ **2â€“3 dana samo PAPER**, Äak i ako bug reÅ¡imo odmah.
   * Tek posle toga, polako vraÄ‡aÅ¡ LIVE u MICRO tier.

---

## 10.7 LIVE PERFORMANCE REVIEW & TUNING

Ovo je stalna rutina, npr.:

* dnevni mini review (10â€“15min)
* nedeljni deep-dive (60â€“90min)

### 10.7.1 Dnevni review

Na kraju trading dana (posle 18:00 UTC):

1. Pregledaj `/monitor`â€“>â€œDan na kratkoâ€:

   * todayPnL %
   * todayWinRate
   * broj trade-ova
   * koliko puta je triggeovan skip po razlogu
   * da li je killSwitch aktiviran (nadam se 0 ğŸ˜„)

2. Ako je dan bio:

   * **odliÄan:** niÅ¡ta ne diraj, samo loguj
   * **loÅ¡:** pogledaj 2â€“3 najgora trejda i vidi:

     * da li su proÅ¡li scoring â‰¥ 70
     * da li je vreme bilo na granici (npr. blizu 18:00)
     * da li je market bio â€œÄudanâ€ (VIX, F&G)

### 10.7.2 Nedeljni review

Jednom nedeljno:

* izvezi `live-trades.jsonl` za tu nedelju
* raÄunaÅ¡:

  * win/loss per sat
  * per dan u nedelji
  * po tipu kretanja (pump/dump/slow grind)

Na osnovu toga radiÅ¡ sitne korekcije u `config/thresholds.json`, **NE** u core kodu (core ostaje stabilan).

---

## âœ… FAZA 10 â€” SUCCESS CRITERIA (KONAÄŒNI)

MoÅ¾emo reÄ‡i da je FAZA 10 kompletirana kada:

1. ImaÅ¡ **â‰¥ 50 LIVE trejdova** (MICRO + SMALL + NORMAL)
2. Ukupan LIVE win rate â‰¥ **65â€“70%**
3. Nisi imao **ni jedan** critical incident bez da safety reaguje
4. KillSwitch, daily loss, time-of-day, weekend filter â€“ sve radi u realnim uslovima
5. Uspostavljen dnevni i nedeljni review ritual
6. **Ti** se oseÄ‡aÅ¡ mirno kad bot trejduje bez da buljiÅ¡ non-stop u ekran.

---

Ako Å¾eliÅ¡ sledeÄ‡i korak, mogu:

* da ti prelomim FAZU 10 u **konkretnu strukturu fajlova + TODO blokove** (npr. `config/`, `src/execution/router.js`, `src/safety/killSwitch.js`, `routes/adminKill.js`, itd.), tako da bukvalno moÅ¾eÅ¡ da poÄneÅ¡ da kucaÅ¡ kod po skeletonu.
